import{T as V,b5 as A,S as E,j as w,o as i,d as c,b as _,w as h,a as o,u as a,F as p,f,g as y,t as k,e as B,I as O,n as F}from"./app-9e91f8b8.js";import{_ as P}from"./PrimaryButton-e84c2a9a.js";import{_ as D}from"./DefaultForm-9d802552.js";import{_ as R}from"./InputLabel-6bfe61e8.js";import{_ as U}from"./Checkbox-63d0d49e.js";import{_ as I,a as T}from"./TextInput-2040c862.js";const q={class:"max-w-5xl mx-auto py-10 sm:px-6 lg:px-8"},z={class:"col-span-6"},L={class:"col-span-6"},M={class:"flex justify-start items-center space-x-4 p-1"},H=o("div",{class:"block font-medium text-sm text-gray-700 dark:text-gray-300"},"Permissions",-1),J={class:"mt-1"},K={class:"bg-slate-50 dark:bg-slate-800"},Q={class:"flex justify-start items-center space-x-4 p-1"},W={class:""},X=["onClick"],Y={class:"grid grid-cols-2 gap-2 sm:grid-cols-4 sm:gap-4 p-2"},Z={class:"flex items-center"},N={class:"ms-2 text-sm text-gray-600 dark:text-gray-400"},G={key:0,class:"font-normal text-sm mt-2 mb-2 text-red-600 dark:text-red-400"},ne={__name:"Form",props:{role:{type:Object,default:()=>({name:"",permissions:[]})},role_permissions:{type:Array,default:()=>[]},permissions:Object},setup(x){const r=x,s=V({...r.role,role_permissions:r.role_permissions}),u=()=>s.role_permissions.length===Object.keys(r.permissions).map(t=>r.permissions[t]).flat().length,l=A({permissions:Object.keys(r.permissions).map(t=>{const e=r.role_permissions.filter(n=>r.permissions[t].map(m=>m.name).includes(n)).length===r.permissions[t].length;return{name:t,selected:e}}),all_permissions_checked:u()}),v=()=>{s.id?C():b()},b=()=>{s.post(route("roles.store"),{errorBag:"roleCreate",preserveScroll:!0})},C=()=>{s.put(route("roles.update",r.role),{errorBag:"roleUpdate",preserveScroll:!0})},S=(t,e)=>{l.permissions.map(n=>{n.name===e&&(n.selected=r.permissions[e].filter(m=>s.role_permissions.includes(m.name)).length===r.permissions[e].length)}),l.all_permissions_checked=u()},j=t=>{l.permissions.map(e=>{e.name===t&&(e.selected=!e.selected)}),l.permissions.find(e=>e.name===t).selected?(r.permissions[t].filter(e=>!s.role_permissions.includes(e.name)).forEach(e=>{s.role_permissions.push(e.name)}),l.all_permissions_checked=u()):(s.role_permissions=s.role_permissions.filter(e=>!r.permissions[t].map(n=>n.name).includes(e)),l.all_permissions_checked=u())},$=()=>{l.all_permissions_checked=!l.all_permissions_checked,l.all_permissions_checked?Object.keys(r.permissions).forEach(t=>{l.permissions.map(e=>{e.name===t&&(e.selected=!0)}),r.permissions[t].filter(e=>!s.role_permissions.includes(e.name)).forEach(e=>{s.role_permissions.push(e.name)})}):(l.permissions.map(t=>{t.selected=!1}),s.role_permissions=[])};return E(()=>s.role_permissions,t=>{s.clearErrors()}),w(()=>{}),(t,e)=>(i(),c("div",q,[_(D,{onSubmitted:v},{form:h(()=>[o("div",z,[_(R,{for:"name",value:"Name"}),_(I,{id:"name",ref:"nameInput",modelValue:a(s).name,"onUpdate:modelValue":e[0]||(e[0]=n=>a(s).name=n),onFocus:e[1]||(e[1]=n=>a(s).clearErrors()),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),_(T,{message:a(s).errors.name,class:"mt-2"},null,8,["message"])]),o("div",L,[o("div",M,[H,o("span",{onClick:$,class:"font-normal text-xs text-gray-300 cursor-pointer"},[l.all_permissions_checked?(i(),c(p,{key:0},[f("Deselect All")],64)):(i(),c(p,{key:1},[f("Select All")],64))])]),o("div",J,[(i(!0),c(p,null,y(x.permissions,(n,m)=>(i(),c("div",{key:m,class:"mb-4 space-y-2"},[o("div",K,[o("div",Q,[o("div",W,k(m),1),o("span",{onClick:d=>j(m),class:"font-normal text-xs text-gray-300 cursor-pointer"},[l.permissions.find(d=>d.name===m).selected?(i(),c(p,{key:0},[f("Deselect All")],64)):(i(),c(p,{key:1},[f("Select All")],64))],8,X)])]),o("div",Y,[(i(!0),c(p,null,y(n,d=>(i(),c("div",{key:d.id,class:"col-span-1"},[o("label",Z,[_(U,{id:d.id,onChange:g=>S(g,m),checked:a(s).role_permissions,"onUpdate:checked":e[2]||(e[2]=g=>a(s).role_permissions=g),value:d.name},null,8,["id","onChange","checked","value"]),o("span",N,k(d.name),1)])]))),128))])]))),128))]),a(s).errors.role_permissions?(i(),c("div",G,k(a(s).errors.role_permissions),1)):B("",!0)])]),actions:h(()=>[_(a(O),{href:t.route("roles.index"),class:"mr-4"},{default:h(()=>[f("Cancel ")]),_:1},8,["href"]),_(P,{class:F({"opacity-25":a(s).processing}),disabled:a(s).processing},{default:h(()=>[f(" Save ")]),_:1},8,["class","disabled"])]),_:1})]))}};export{ne as default};
