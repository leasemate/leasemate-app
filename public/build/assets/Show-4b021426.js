import{K as $,h as O,r as v,x as P,i as R,j as N,O as h,k as T,o as r,d as i,b as a,u as n,w as o,F as k,Z as j,f as u,t as l,a as e,g as z,n as y,c as B,v as V}from"./app-59b9daaa.js";import{_ as M,f as q}from"./AuthenticatedLayout-cbc62cb8.js";import{_ as I}from"./PrimaryLink-cd1f2fb6.js";import{T as K}from"./Table-397ff713.js";import{V as U,p as G,s as J}from"./filepond.min-7c4f3e2f.js";import{_ as Q,a as X}from"./Associates-58d50a5e.js";import{_ as Z}from"./Modal-8601880e.js";import{_ as H}from"./SecondaryButton-f26f8088.js";import{_ as b}from"./DangerButton-9d8a92ba.js";import{t as w}from"./toast-03abc5d7.js";import"./DropdownLink-49a47c87.js";import"./ToastList-a0a0e15f.js";import"./_plugin-vue_export-helper-c27b6911.js";const W={class:"flex justify-end"},Y=e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}),e("th",{scope:"col",class:"px-6 py-3"}),e("th",{scope:"col",class:"px-6 py-3"}," Name "),e("th",{scope:"col",class:"px-6 py-3"}," Address "),e("th",{scope:"col",class:"px-6 py-3"}," GLA (SQFT) "),e("th",{scope:"col",class:"px-6 py-3"}," Start Date "),e("th",{scope:"col",class:"px-6 py-3"}," End Date "),e("th",{scope:"col",class:"px-6 py-3"}," Rent / Sq Ft "),e("th")],-1),ee={scope:"row",class:"px-6 py-4 space-x-2"},se={class:"relative mr-1.5 flex h-2.5 w-2.5"},te=e("td",{class:"px-6 py-4 space-x-2"},null,-1),ae={class:"px-6 py-4 text-gray-900"},oe=["href"],le={class:"px-6 py-4 dark:text-zinc-100/80"},re={class:"px-6 py-4 dark:text-zinc-100/80"},ne={class:"px-6 py-4 dark:text-zinc-100/80"},ce={class:"px-6 py-4 space-x-2"},ie={class:"px-6 py-4 space-x-2"},de={class:"px-6 py-4 space-x-2"},pe={class:"p-6"},ue=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this lease? ",-1),fe={class:"mt-6 flex justify-end"},Ae={__name:"Show",props:{asset:Object,associates:Array,leases:Array},setup(d){const p=d,f=$(),C=O(()=>f.props.auth.user);v(p.leases),P(p.leases,(s,m)=>{console.log("props.leases has changed:",s)},{deep:!0});const{getFileStatusClass:_}=q();R({});const x=v(null),g=v(!1),E=s=>{g.value=!0,x.value=s},S=()=>{g.value=!1},F=()=>{if(x.value){S();try{h.delete(route("assets.leases.destroy",[p.asset,x.value.id]),{preserveScroll:!0,onSuccess:()=>{},onError:()=>{}})}catch(s){w.error(s),console.log(s)}}},A=U(G);let c="";J({credits:[],required:!0,allowMultiple:!0,allowRevert:!1,acceptedFileTypes:["application/pdf"],server:{process:{url:route("assets.leases.store",p.asset),headers:{Accept:"application/json","X-CSRF-TOKEN":f.props.csrf},onsuccess:s=>{console.log("on success"),console.log(s)},onerror:s=>{console.log("on error"),c=JSON.parse(s)}}},labelFileProcessingError:s=>(console.log(s),console.log(c),c.errors&&c.errors.lease_document?c.errors.lease_document.join(" "):c.message)});const D=(s,m)=>{h.reload({only:["leases"]})},L=()=>{};return N(()=>{Echo.private(`tenant-global-channel.${f.props.tenant_id}`).listen("LeaseFileDeleted",s=>{w.success(s.lease_deleted.og_filename+": Deleted successfully"),h.reload({preserveScroll:!0})}).listen("FileStatusUpdate",s=>{h.reload({preserveScroll:!0})})}),T(()=>{C.value&&Echo.leave(`tenant-global-channel.${f.props.tenant_id}`)}),(s,m)=>(r(),i(k,null,[a(n(j),{title:"Asset"}),a(M,null,{header:o(()=>[u(" Asset - "+l(d.asset.name),1)]),default:o(()=>[e("div",W,[a(I,{href:s.route("assets.edit",d.asset)},{default:o(()=>[u("Edit Asset")]),_:1},8,["href"])]),a(Q,{asset:d.asset},null,8,["asset"]),a(X,{associates:d.associates},null,8,["associates"]),a(n(A),{name:"lease_document",onInit:L,onProcessfile:D,ref:"pond","class-name":"my-file-upload","label-idle":"Lease Drop or <span class='filepond--label-action'>Browse</span>"},null,512),a(K,null,{head:o(()=>[Y]),body:o(()=>[(r(!0),i(k,null,z(p.leases,t=>(r(),i("tr",{key:t.id,class:"bg-white border-b border-gray-50 dark:bg-zinc-700/50 dark:border-zinc-600"},[e("th",ee,[e("span",{class:y(["inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset",n(_)(t.status)])},[e("span",se,[["Ready","Failed"].includes(t.status)?(r(),i("span",{key:1,class:y(["relative inline-flex h-2.5 w-2.5 rounded-full",n(_)(t.status,"PROCESS_CLASSES")])},null,2)):(r(),i(k,{key:0},[e("span",{class:y(["absolute inline-flex h-full w-full animate-ping rounded-full",n(_)(t.status,"PROCESS_CLASSES")])},null,2),e("span",{class:y(["relative inline-flex h-2.5 w-2.5 rounded-full",n(_)(t.status,"PROCESS_CLASSES")])},null,2)],64))]),e("span",null,l(t.status),1)],2)]),te,e("td",ae,[t.tenant_name?(r(),B(n(V),{key:0,href:s.route("assets.leases.show",[t.asset_id,t.id])},{default:o(()=>[e("strong",null,l(t.tenant_name),1)]),_:2},1032,["href"])):(r(),i("a",{key:1,href:t.filename,target:"_blank",rel:"noopener noreferrer",class:"font-medium"},l(t.og_filename),9,oe))]),e("td",le,l(t.address??"--"),1),e("td",re,l(s.filters.formatNumber(t.gla)??"--"),1),e("td",ne,l(t.start_date??"--"),1),e("td",ce,l(t.end_date??"--"),1),e("td",ie,l(s.filters.formatMoney(t.rent_per_sqft)??"--"),1),e("td",de,[a(b,{href:s.route("assets.leases.edit",[t.asset_id,t.id]),class:"text-sm",onClick:_e=>E(t)},{default:o(()=>[u(" Delete ")]),_:2},1032,["href","onClick"])])]))),128))]),_:1}),a(Z,{show:g.value,onClose:S},{default:o(()=>[e("div",pe,[ue,e("div",fe,[a(H,{onClick:S},{default:o(()=>[u(" Cancel ")]),_:1}),a(b,{class:"ml-3",onClick:m[0]||(m[0]=t=>F())},{default:o(()=>[u(" Delete ")]),_:1})])])]),_:1},8,["show"])]),_:1})],64))}};export{Ae as default};
