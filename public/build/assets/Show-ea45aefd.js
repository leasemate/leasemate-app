import{K as $,h as O,r as v,x as P,i as R,j as T,O as h,k as j,o as n,d as i,b as a,u as r,w as o,F as k,Z as z,f as u,t as l,a as e,g as B,n as y,c as N,v as V}from"./app-5aeba88c.js";import{_ as M,f as q}from"./AuthenticatedLayout-c85153ef.js";import{_ as I}from"./PrimaryLink-dfc33aa1.js";import{T as K}from"./Table-c3101839.js";import{V as U,p as G,s as J}from"./filepond.min-f9a0e59b.js";import{_ as Q,a as X}from"./Associates-06eeb9eb.js";import{_ as Z}from"./Modal-020ced38.js";import{_ as H}from"./SecondaryButton-b6a12717.js";import{_ as b}from"./DangerButton-77242ce2.js";import{t as w}from"./toast-048a9c86.js";import"./DropdownLink-f78391f5.js";import"./ToastList-fcd1e596.js";import"./_plugin-vue_export-helper-c27b6911.js";const W={class:"flex justify-end"},Y=e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}),e("th",{scope:"col",class:"px-6 py-3"}),e("th",{scope:"col",class:"px-6 py-3"}," Name "),e("th",{scope:"col",class:"px-6 py-3"}," Address "),e("th",{scope:"col",class:"px-6 py-3"}," GLA (SQFT) "),e("th",{scope:"col",class:"px-6 py-3"}," Start Date "),e("th",{scope:"col",class:"px-6 py-3"}," End Date "),e("th",{scope:"col",class:"px-6 py-3"}," Rent / Sq Ft "),e("th")],-1),ee={scope:"row",class:"px-6 py-4 space-x-2"},se={class:"relative mr-1.5 flex h-2.5 w-2.5"},te=e("td",{class:"px-6 py-4 space-x-2"},null,-1),ae={class:"px-6 py-4 text-gray-900"},oe=["href"],le={class:"px-6 py-4 dark:text-zinc-100/80"},ne={class:"px-6 py-4 dark:text-zinc-100/80"},re={class:"px-6 py-4 dark:text-zinc-100/80"},ce={class:"px-6 py-4 space-x-2"},ie={class:"px-6 py-4 space-x-2"},de={class:"px-6 py-4 space-x-2"},pe={class:"p-6"},ue=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this lease? ",-1),fe={class:"mt-6 flex justify-end"},Ae={__name:"Show",props:{asset:Object,associates:Array,leases:Array},setup(d){const p=d,f=$(),C=O(()=>f.props.auth.user);v(p.leases),P(p.leases,(t,m)=>{console.log("props.leases has changed:",t)},{deep:!0});const{getFileStatusClass:_}=q();R({});const x=v(null),g=v(!1),E=t=>{g.value=!0,x.value=t},S=()=>{g.value=!1},F=()=>{if(x.value){S();try{h.delete(route("assets.leases.destroy",[p.asset,x.value.id]),{preserveScroll:!0,onSuccess:()=>{},onError:()=>{}})}catch(t){w.error(t),console.log(t)}}},A=U(G);let c="";J({credits:[],required:!0,allowMultiple:!0,allowRevert:!1,acceptedFileTypes:["application/pdf"],server:{process:{url:route("assets.leases.store",p.asset),headers:{Accept:"application/json","X-CSRF-TOKEN":f.props.csrf},onsuccess:t=>{console.log("on success"),console.log(t)},onerror:t=>{console.log("on error"),c=JSON.parse(t)}}},labelFileProcessingError:t=>(console.log(t),console.log(c),c.errors&&c.errors.lease_document?c.errors.lease_document.join(" "):c.message)});const D=(t,m)=>{h.reload({only:["leases"]})},L=()=>{};return T(()=>{Echo.private(`tenant-global-channel.${f.props.tenant_id}`).listen("LeaseFileDeleted",t=>{w.success(t.lease_deleted.og_filename+": Deleted successfully"),h.reload({preserveScroll:!0})}).listen("FileStatusUpdate",t=>{h.reload({preserveScroll:!0})})}),j(()=>{C.value&&Echo.leave(`tenant-global-channel.${f.props.tenant_id}`)}),(t,m)=>(n(),i(k,null,[a(r(z),{title:"Asset"}),a(M,null,{header:o(()=>[u(" Asset - "+l(d.asset.name),1)]),default:o(()=>[e("div",W,[a(I,{href:t.route("assets.edit",d.asset)},{default:o(()=>[u("Edit Asset")]),_:1},8,["href"])]),a(Q,{asset:d.asset},null,8,["asset"]),a(X,{associates:d.associates},null,8,["associates"]),a(r(A),{name:"lease_document",onInit:L,onProcessfile:D,ref:"pond","class-name":"my-file-upload","label-idle":"Lease Drop or <span class='filepond--label-action'>Browse</span>"},null,512),a(K,null,{head:o(()=>[Y]),body:o(()=>[(n(!0),i(k,null,B(p.leases,s=>(n(),i("tr",{key:s.id,class:"bg-white border-b border-gray-50 dark:bg-zinc-700/50 dark:border-zinc-600"},[e("th",ee,[e("span",{class:y(["inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset",r(_)(s.status)])},[e("span",se,[["Ready","Failed"].includes(s.status)?(n(),i("span",{key:1,class:y(["relative inline-flex h-2.5 w-2.5 rounded-full",r(_)(s.status,"PROCESS_CLASSES")])},null,2)):(n(),i(k,{key:0},[e("span",{class:y(["absolute inline-flex h-full w-full animate-ping rounded-full",r(_)(s.status,"PROCESS_CLASSES")])},null,2),e("span",{class:y(["relative inline-flex h-2.5 w-2.5 rounded-full",r(_)(s.status,"PROCESS_CLASSES")])},null,2)],64))]),e("span",null,l(s.status),1)],2)]),te,e("td",ae,[s.tenant_name?(n(),N(r(V),{key:0,href:t.route("assets.leases.show",[s.asset_id,s.id])},{default:o(()=>[e("strong",null,l(s.tenant_name),1)]),_:2},1032,["href"])):(n(),i("a",{key:1,href:s.filename,target:"_blank",rel:"noopener noreferrer",class:"font-medium"},l(s.og_filename),9,oe))]),e("td",le,l(s.address??"--"),1),e("td",ne,l(s.gla??"--"),1),e("td",re,l(s.start_date??"--"),1),e("td",ce,l(s.end_date??"--"),1),e("td",ie,l(t.filters.formatMoney(s.rent_per_sqft)??"--"),1),e("td",de,[a(b,{href:t.route("assets.leases.edit",[s.asset_id,s.id]),class:"text-sm",onClick:_e=>E(s)},{default:o(()=>[u(" Delete ")]),_:2},1032,["href","onClick"])])]))),128))]),_:1}),a(Z,{show:g.value,onClose:S},{default:o(()=>[e("div",pe,[ue,e("div",fe,[a(H,{onClick:S},{default:o(()=>[u(" Cancel ")]),_:1}),a(b,{class:"ml-3",onClick:m[0]||(m[0]=s=>F())},{default:o(()=>[u(" Delete ")]),_:1})])])]),_:1},8,["show"])]),_:1})],64))}};export{Ae as default};
