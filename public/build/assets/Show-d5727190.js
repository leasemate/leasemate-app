import{o as r,c as F,w as o,j as w,u as d,K as A,d as i,n as _,Q as B,s as j,r as S,L as z,M as N,y as M,O as y,A as V,b as a,F as k,h as q,Z as I,f,t as l,a as e,g as K,i as Q}from"./app-1f836617.js";import{_ as U,f as G}from"./AuthenticatedLayout-4c5e814a.js";import{_ as J}from"./PrimaryLink-f09b310e.js";import{T as X}from"./Table-789c3f48.js";import{V as Z,p as H,s as W}from"./filepond.min-27ab50b8.js";import{_ as Y,a as ee}from"./Associates-47668594.js";import{_ as se}from"./Modal-d90cabd0.js";import{_ as te}from"./SecondaryButton-7f15abeb.js";import{_ as C}from"./DangerButton-5eabc981.js";import{t as $}from"./toast-99e37765.js";import"./DropdownLink-1fab562f.js";import"./ToastList-d99203fa.js";import"./_plugin-vue_export-helper-c27b6911.js";const ae={key:1,class:"inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-md font-semibold text-gray-700 dark:text-gray-300 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-25 transition ease-in-out duration-150",target:"_blank",rel:"noopener noreferrer"},oe={__name:"SecondaryLink",props:{type:{type:String,default:"internal"}},setup(n){return(c,g)=>n.type=="internal"?(r(),F(d(A),{key:0,class:"inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-md font-semibold text-gray-700 dark:text-gray-300 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-25 transition ease-in-out duration-150"},{default:o(()=>[w(c.$slots,"default")]),_:3})):(r(),i("a",ae,[w(c.$slots,"default")]))}},re={__name:"BoxIcon",props:{class:{type:String,default:"button"}},setup(n){return(c,g)=>(r(),i("i",{class:_(["bx text-[20px]",n.class])},null,2))}},le={class:"flex justify-end"},ne=e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}),e("th",{scope:"col",class:"px-6 py-3"}," Name "),e("th",{scope:"col",class:"px-6 py-3"}," Address "),e("th",{scope:"col",class:"px-6 py-3"}," GLA (SQFT) "),e("th",{scope:"col",class:"px-6 py-3"}," Start Date "),e("th",{scope:"col",class:"px-6 py-3"}," End Date "),e("th",{scope:"col",class:"px-6 py-3"}," Rent / Sq Ft "),e("th")],-1),ie={scope:"row",class:"px-6 py-4 space-x-2"},ce={class:"relative mr-1.5 flex h-2.5 w-2.5"},de={class:"whitespace-nowrap"},pe={class:"px-6 py-4 text-gray-900"},ue=["href"],fe={class:"px-6 py-4 dark:text-zinc-100/80"},_e={class:"px-6 py-4 dark:text-zinc-100/80"},me={class:"px-6 py-4 dark:text-zinc-100/80"},he={class:"px-6 py-4 space-x-2"},ye={class:"px-6 py-4 space-x-2"},ge={class:"px-6 py-4"},xe={class:"flex items-center space-x-2"},be={class:"p-6"},ve=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this lease? ",-1),Se={class:"mt-6 flex justify-end"},je={__name:"Show",props:{asset:Object,associates:Array,leases:Array},setup(n){const c=B(),g=j(()=>c.props.auth.user),u=n;S(u.leases),z(u.leases,(t,h)=>{console.log("props.leases has changed:",t)},{deep:!0});const{getFileStatusClass:m}=G();N({});const x=S(null),b=S(!1),D=t=>{b.value=!0,x.value=t},v=()=>{b.value=!1},E=()=>{if(x.value){v();try{y.delete(route("assets.leases.destroy",[u.asset,x.value.id]),{preserveScroll:!0})}catch(t){$.error(t),console.log(t)}}},L=Z(H);let p="";W({credits:[],required:!0,allowMultiple:!0,allowRevert:!1,acceptedFileTypes:["application/pdf"],server:{process:{url:route("assets.leases.store",u.asset),headers:{Accept:"application/json","X-CSRF-TOKEN":c.props.csrf},onsuccess:t=>{console.log("on success"),console.log(t)},onerror:t=>{console.log("on error"),p=JSON.parse(t)}}},labelFileProcessingError:t=>(console.log(t),console.log(p),p.errors&&p.errors.lease_document?p.errors.lease_document.join(" "):p.message)});const O=t=>t.status=="Failed"?{value:t.status_msg,pt:{arrow:{style:{borderRightColor:"var(--primary-color)"}},text:"rounded-md px-2 py-1 text-xs ring-1 ring-inset bg-red-50 text-red-800 ring-red-600/20"}}:null,R=(t,h)=>{y.reload({only:["leases"]})},P=()=>{};return M(()=>{Echo.private(`tenant-global-channel.${c.props.tenant_id}`).listen("LeaseFileDeleted",t=>{$.success(t.lease_deleted.og_filename+": Deleted successfully"),y.reload({preserveScroll:!0})}).listen("FileStatusUpdate",t=>{y.reload({preserveScroll:!0})})}),V(()=>{g.value&&Echo.leave(`tenant-global-channel.${c.props.tenant_id}`)}),(t,h)=>{const T=q("tooltip");return r(),i(k,null,[a(d(I),{title:"Asset"}),a(U,null,{header:o(()=>[f(" Asset - "+l(n.asset.name),1)]),default:o(()=>[e("div",le,[a(J,{href:t.route("assets.edit",n.asset)},{default:o(()=>[f("Edit Asset")]),_:1},8,["href"])]),a(Y,{asset:n.asset},null,8,["asset"]),a(ee,{associates:n.associates},null,8,["associates"]),a(d(L),{name:"lease_document",onInit:P,onProcessfile:R,ref:"pond","class-name":"my-file-upload","label-idle":"Lease Drop or <span class='filepond--label-action'>Browse</span>"},null,512),a(X,null,{head:o(()=>[ne]),body:o(()=>[(r(!0),i(k,null,K(u.leases,s=>(r(),i("tr",{key:s.id,class:"bg-white border-b border-gray-50 dark:bg-zinc-700/50 dark:border-zinc-600"},[e("th",ie,[Q((r(),i("span",{class:_(["inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset",d(m)(s.status)])},[e("span",ce,[["Ready","Failed"].includes(s.status)?(r(),i("span",{key:1,class:_(["relative inline-flex h-2.5 w-2.5 rounded-full",d(m)(s.status,"PROCESS_CLASSES")])},null,2)):(r(),i(k,{key:0},[e("span",{class:_(["absolute inline-flex h-full w-full animate-ping rounded-full",d(m)(s.status,"PROCESS_CLASSES")])},null,2),e("span",{class:_(["relative inline-flex h-2.5 w-2.5 rounded-full",d(m)(s.status,"PROCESS_CLASSES")])},null,2)],64))]),e("span",de,l(s.status)+" "+l(s.status_progress),1)],2)),[[T,O(s)]])]),e("td",pe,[s.tenant_name?(r(),F(d(A),{key:0,href:t.route("assets.leases.show",[s.asset_id,s.id])},{default:o(()=>[e("strong",null,l(s.tenant_name),1)]),_:2},1032,["href"])):(r(),i("a",{key:1,href:s.filename,type:"external",target:"_blank",class:"text-gray-500"},l(s.og_filename),9,ue))]),e("td",fe,l(s.address??"--"),1),e("td",_e,l(s.gla??"--"),1),e("td",me,l(s.start_date??"--"),1),e("td",he,l(s.end_date??"--"),1),e("td",ye,l(t.filters.formatMoney(s.rent_per_sqft)??"--"),1),e("td",ge,[e("div",xe,[a(oe,{href:s.filename,type:"external"},{default:o(()=>[a(re,{class:"bx-cloud-download"})]),_:2},1032,["href"]),a(C,{href:t.route("assets.leases.edit",[s.asset_id,s.id]),class:"text-sm",onClick:ke=>D(s),disabled:s.is_deleting},{default:o(()=>[f(" Delete ")]),_:2},1032,["href","onClick","disabled"])])])]))),128))]),_:1}),a(se,{show:b.value,onClose:v},{default:o(()=>[e("div",be,[ve,e("div",Se,[a(te,{onClick:v},{default:o(()=>[f(" Cancel ")]),_:1}),a(C,{class:"ml-3",onClick:h[0]||(h[0]=s=>E())},{default:o(()=>[f(" Delete ")]),_:1})])])]),_:1},8,["show"])]),_:1})],64)}}};export{je as default};
