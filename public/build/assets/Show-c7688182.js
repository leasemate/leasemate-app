import{o as r,c as k,w as o,j as C,u as c,L as w,d,n as _,K as B,s as N,r as v,M as j,N as z,y as M,O as y,A as V,h as q,b as a,F as S,Z as I,f,t as l,a as e,g as K,i as U}from"./app-9523172d.js";import{_ as G,f as J}from"./AuthenticatedLayout-2b0000c2.js";import{_ as Q}from"./PrimaryLink-19d3d23a.js";import{T as X}from"./Table-9bb7ee3e.js";import{V as Z,p as H,s as W}from"./filepond.min-36298af3.js";import{_ as Y,a as ee}from"./Associates-b8f1fa66.js";import{_ as se}from"./Modal-570b98ce.js";import{_ as te}from"./SecondaryButton-fdbabe5c.js";import{_ as $}from"./DangerButton-36ab1c02.js";import{t as F}from"./toast-00c7c125.js";import"./DropdownLink-7688e2f2.js";import"./ToastList-5c2a6c0e.js";import"./_plugin-vue_export-helper-c27b6911.js";const ae={key:1,class:"inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-md font-semibold text-gray-700 dark:text-gray-300 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-25 transition ease-in-out duration-150",target:"_blank",rel:"noopener noreferrer"},oe={__name:"SecondaryLink",props:{type:{type:String,default:"internal"}},setup(n){return(i,p)=>n.type=="internal"?(r(),k(c(w),{key:0,class:"inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-md font-semibold text-gray-700 dark:text-gray-300 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-25 transition ease-in-out duration-150"},{default:o(()=>[C(i.$slots,"default")]),_:3})):(r(),d("a",ae,[C(i.$slots,"default")]))}},re={__name:"BoxIcon",props:{class:{type:String,default:"button"}},setup(n){return(i,p)=>(r(),d("i",{class:_(["bx text-[20px]",n.class])},null,2))}},le={class:"flex justify-end"},ne=e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}),e("th",{scope:"col",class:"px-6 py-3"}," Name "),e("th",{scope:"col",class:"px-6 py-3"}," Address "),e("th",{scope:"col",class:"px-6 py-3"}," GLA (SQFT) "),e("th",{scope:"col",class:"px-6 py-3"}," Start Date "),e("th",{scope:"col",class:"px-6 py-3"}," End Date "),e("th",{scope:"col",class:"px-6 py-3"}," Rent / Sq Ft "),e("th")],-1),ie={scope:"row",class:"px-6 py-4 space-x-2"},ce={class:"relative mr-1.5 flex h-2.5 w-2.5"},de={class:"whitespace-nowrap"},pe={class:"px-6 py-4 text-gray-900"},ue={class:"px-6 py-4 dark:text-zinc-100/80"},fe={class:"px-6 py-4 dark:text-zinc-100/80"},_e={class:"px-6 py-4 dark:text-zinc-100/80"},me={class:"px-6 py-4 space-x-2"},he={class:"px-6 py-4 space-x-2"},ye={class:"px-6 py-4"},ge={class:"flex items-center space-x-2"},xe={class:"p-6"},be=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this lease? ",-1),ve={class:"mt-6 flex justify-end"},Be={__name:"Show",props:{asset:Object,associates:Array,leases:Array},setup(n){const i=n,p=B(),A=N(()=>p.props.auth.user);v(i.leases),j(i.leases,(t,h)=>{console.log("props.leases has changed:",t)},{deep:!0});const{getFileStatusClass:m}=J();z({});const g=v(null),x=v(!1),D=t=>{x.value=!0,g.value=t},b=()=>{x.value=!1},E=()=>{if(g.value){b();try{y.delete(route("assets.leases.destroy",[i.asset,g.value.id]),{preserveScroll:!0})}catch(t){F.error(t),console.log(t)}}},L=Z(H);let u="";W({credits:[],required:!0,allowMultiple:!0,allowRevert:!1,acceptedFileTypes:["application/pdf"],server:{process:{url:route("assets.leases.store",i.asset),headers:{Accept:"application/json","X-CSRF-TOKEN":p.props.csrf},onsuccess:t=>{console.log("on success"),console.log(t)},onerror:t=>{console.log("on error"),u=JSON.parse(t)}}},labelFileProcessingError:t=>(console.log(t),console.log(u),u.errors&&u.errors.lease_document?u.errors.lease_document.join(" "):u.message)});const O=t=>t.status=="Failed"?{value:t.status_msg,pt:{arrow:{style:{borderRightColor:"var(--primary-color)"}},text:"rounded-md px-2 py-1 text-xs ring-1 ring-inset bg-red-50 text-red-800 ring-red-600/20"}}:null,R=(t,h)=>{y.reload({only:["leases"]})},P=()=>{};return M(()=>{Echo.private(`tenant-global-channel.${p.props.tenant_id}`).listen("LeaseFileDeleted",t=>{F.success(t.lease_deleted.og_filename+": Deleted successfully"),y.reload({preserveScroll:!0})}).listen("FileStatusUpdate",t=>{y.reload({preserveScroll:!0})})}),V(()=>{A.value&&Echo.leave(`tenant-global-channel.${p.props.tenant_id}`)}),(t,h)=>{const T=q("tooltip");return r(),d(S,null,[a(c(I),{title:"Asset"}),a(G,null,{header:o(()=>[f(" Asset - "+l(n.asset.name),1)]),default:o(()=>[e("div",le,[a(Q,{href:t.route("assets.edit",n.asset)},{default:o(()=>[f("Edit Asset")]),_:1},8,["href"])]),a(Y,{asset:n.asset},null,8,["asset"]),a(ee,{associates:n.associates},null,8,["associates"]),a(c(L),{name:"lease_document",onInit:P,onProcessfile:R,ref:"pond","class-name":"my-file-upload","label-idle":"Lease Drop or <span class='filepond--label-action'>Browse</span>"},null,512),a(X,null,{head:o(()=>[ne]),body:o(()=>[(r(!0),d(S,null,K(i.leases,s=>(r(),d("tr",{key:s.id,class:"bg-white border-b border-gray-50 dark:bg-zinc-700/50 dark:border-zinc-600"},[e("th",ie,[U((r(),d("span",{class:_(["inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset",c(m)(s.status)])},[e("span",ce,[["Ready","Failed"].includes(s.status)?(r(),d("span",{key:1,class:_(["relative inline-flex h-2.5 w-2.5 rounded-full",c(m)(s.status,"PROCESS_CLASSES")])},null,2)):(r(),d(S,{key:0},[e("span",{class:_(["absolute inline-flex h-full w-full animate-ping rounded-full",c(m)(s.status,"PROCESS_CLASSES")])},null,2),e("span",{class:_(["relative inline-flex h-2.5 w-2.5 rounded-full",c(m)(s.status,"PROCESS_CLASSES")])},null,2)],64))]),e("span",de,l(s.status)+" "+l(s.status_progress),1)],2)),[[T,O(s)]])]),e("td",pe,[s.tenant_name?(r(),k(c(w),{key:0,href:t.route("assets.leases.show",[s.asset_id,s.id])},{default:o(()=>[e("strong",null,l(s.tenant_name),1)]),_:2},1032,["href"])):(r(),k(c(w),{key:1,href:s.filename,type:"external",class:"text-gray-500"},{default:o(()=>[f(l(s.og_filename),1)]),_:2},1032,["href"]))]),e("td",ue,l(s.address??"--"),1),e("td",fe,l(s.gla??"--"),1),e("td",_e,l(s.start_date??"--"),1),e("td",me,l(s.end_date??"--"),1),e("td",he,l(t.filters.formatMoney(s.rent_per_sqft)??"--"),1),e("td",ye,[e("div",ge,[a(oe,{href:s.filename,type:"external"},{default:o(()=>[a(re,{class:"bx-cloud-download"})]),_:2},1032,["href"]),a($,{href:t.route("assets.leases.edit",[s.asset_id,s.id]),class:"text-sm",onClick:Se=>D(s),disabled:s.is_deleting},{default:o(()=>[f(" Delete ")]),_:2},1032,["href","onClick","disabled"])])])]))),128))]),_:1}),a(se,{show:x.value,onClose:b},{default:o(()=>[e("div",xe,[be,e("div",ve,[a(te,{onClick:b},{default:o(()=>[f(" Cancel ")]),_:1}),a($,{class:"ml-3",onClick:h[0]||(h[0]=s=>E())},{default:o(()=>[f(" Delete ")]),_:1})])])]),_:1},8,["show"])]),_:1})],64)}}};export{Be as default};
