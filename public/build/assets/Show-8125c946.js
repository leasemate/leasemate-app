import{o as r,c as k,w as o,j as C,u as c,L as w,d,n as _,K as B,s as N,r as v,M as j,N as z,y as M,O as y,A as V,h as q,b as a,F as S,Z as I,f,t as i,a as e,g as K,i as U}from"./app-474186b5.js";import{_ as G,f as J}from"./AuthenticatedLayout-05868817.js";import{_ as Q}from"./PrimaryLink-7599f9b8.js";import{T as X}from"./Table-c989434f.js";import{V as Z,p as H,s as W}from"./filepond.min-7b0642cb.js";import{_ as Y,a as ee}from"./Associates-1ba67763.js";import{_ as se}from"./Modal-b3ee0cb8.js";import{_ as te}from"./SecondaryButton-05a5b255.js";import{_ as $}from"./DangerButton-69aa35a9.js";import{t as F}from"./toast-b7373d7d.js";import"./DropdownLink-b2427251.js";import"./ToastList-0c5dc55d.js";import"./_plugin-vue_export-helper-c27b6911.js";const ae={key:1,class:"inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-md font-semibold text-gray-700 dark:text-gray-300 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-25 transition ease-in-out duration-150",target:"_blank",rel:"noopener noreferrer"},oe={__name:"SecondaryLink",props:{type:{type:String,default:"internal"}},setup(l){return(n,p)=>l.type=="internal"?(r(),k(c(w),{key:0,class:"inline-flex items-center px-2 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-md font-semibold text-gray-700 dark:text-gray-300 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-25 transition ease-in-out duration-150"},{default:o(()=>[C(n.$slots,"default")]),_:3})):(r(),d("a",ae,[C(n.$slots,"default")]))}},re={__name:"BoxIcon",props:{class:{type:String,default:"button"}},setup(l){return(n,p)=>(r(),d("i",{class:_(["bx text-[20px]",l.class])},null,2))}},le={class:"flex justify-end"},ne=e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}),e("th",{scope:"col",class:"px-6 py-3"}," Name "),e("th",{scope:"col",class:"px-6 py-3"}," Address "),e("th",{scope:"col",class:"px-6 py-3"}," GLA (SQFT) "),e("th",{scope:"col",class:"px-6 py-3"}," Start Date "),e("th",{scope:"col",class:"px-6 py-3"}," End Date "),e("th",{scope:"col",class:"px-6 py-3"}," Rent / Sq Ft "),e("th")],-1),ie={scope:"row",class:"px-6 py-4 space-x-2"},ce={class:"relative mr-1.5 flex h-2.5 w-2.5"},de={class:"px-6 py-4 text-gray-900"},pe={class:"px-6 py-4 dark:text-zinc-100/80"},ue={class:"px-6 py-4 dark:text-zinc-100/80"},fe={class:"px-6 py-4 dark:text-zinc-100/80"},_e={class:"px-6 py-4 space-x-2"},me={class:"px-6 py-4 space-x-2"},he={class:"px-6 py-4"},ye={class:"flex items-center space-x-2"},ge={class:"p-6"},xe=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this lease? ",-1),be={class:"mt-6 flex justify-end"},Te={__name:"Show",props:{asset:Object,associates:Array,leases:Array},setup(l){const n=l,p=B(),E=N(()=>p.props.auth.user);v(n.leases),j(n.leases,(s,h)=>{console.log("props.leases has changed:",s)},{deep:!0});const{getFileStatusClass:m}=J();z({});const g=v(null),x=v(!1),A=s=>{x.value=!0,g.value=s},b=()=>{x.value=!1},D=()=>{if(g.value){b();try{y.delete(route("assets.leases.destroy",[n.asset,g.value.id]),{preserveScroll:!0,onSuccess:()=>{},onError:()=>{}})}catch(s){F.error(s),console.log(s)}}},L=Z(H);let u="";W({credits:[],required:!0,allowMultiple:!0,allowRevert:!1,acceptedFileTypes:["application/pdf"],server:{process:{url:route("assets.leases.store",n.asset),headers:{Accept:"application/json","X-CSRF-TOKEN":p.props.csrf},onsuccess:s=>{console.log("on success"),console.log(s)},onerror:s=>{console.log("on error"),u=JSON.parse(s)}}},labelFileProcessingError:s=>(console.log(s),console.log(u),u.errors&&u.errors.lease_document?u.errors.lease_document.join(" "):u.message)});const O=s=>s.status=="Failed"?{value:s.status_msg,pt:{arrow:{style:{borderRightColor:"var(--primary-color)"}},text:"rounded-md px-2 py-1 text-xs ring-1 ring-inset bg-red-50 text-red-800 ring-red-600/20"}}:null,R=(s,h)=>{y.reload({only:["leases"]})},P=()=>{};return M(()=>{Echo.private(`tenant-global-channel.${p.props.tenant_id}`).listen("LeaseFileDeleted",s=>{F.success(s.lease_deleted.og_filename+": Deleted successfully"),y.reload({preserveScroll:!0})}).listen("FileStatusUpdate",s=>{y.reload({preserveScroll:!0})})}),V(()=>{E.value&&Echo.leave(`tenant-global-channel.${p.props.tenant_id}`)}),(s,h)=>{const T=q("tooltip");return r(),d(S,null,[a(c(I),{title:"Asset"}),a(G,null,{header:o(()=>[f(" Asset - "+i(l.asset.name),1)]),default:o(()=>[e("div",le,[a(Q,{href:s.route("assets.edit",l.asset)},{default:o(()=>[f("Edit Asset")]),_:1},8,["href"])]),a(Y,{asset:l.asset},null,8,["asset"]),a(ee,{associates:l.associates},null,8,["associates"]),a(c(L),{name:"lease_document",onInit:P,onProcessfile:R,ref:"pond","class-name":"my-file-upload","label-idle":"Lease Drop or <span class='filepond--label-action'>Browse</span>"},null,512),a(X,null,{head:o(()=>[ne]),body:o(()=>[(r(!0),d(S,null,K(n.leases,t=>(r(),d("tr",{key:t.id,class:"bg-white border-b border-gray-50 dark:bg-zinc-700/50 dark:border-zinc-600"},[e("th",ie,[U((r(),d("span",{class:_(["inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset",c(m)(t.status)])},[e("span",ce,[["Ready","Failed"].includes(t.status)?(r(),d("span",{key:1,class:_(["relative inline-flex h-2.5 w-2.5 rounded-full",c(m)(t.status,"PROCESS_CLASSES")])},null,2)):(r(),d(S,{key:0},[e("span",{class:_(["absolute inline-flex h-full w-full animate-ping rounded-full",c(m)(t.status,"PROCESS_CLASSES")])},null,2),e("span",{class:_(["relative inline-flex h-2.5 w-2.5 rounded-full",c(m)(t.status,"PROCESS_CLASSES")])},null,2)],64))]),e("span",null,i(t.status),1)],2)),[[T,O(t)]])]),e("td",de,[t.tenant_name?(r(),k(c(w),{key:0,href:s.route("assets.leases.show",[t.asset_id,t.id])},{default:o(()=>[e("strong",null,i(t.tenant_name),1)]),_:2},1032,["href"])):(r(),k(c(w),{key:1,href:t.filename,type:"external",class:"text-gray-500"},{default:o(()=>[f(i(t.og_filename),1)]),_:2},1032,["href"]))]),e("td",pe,i(t.address??"--"),1),e("td",ue,i(t.gla??"--"),1),e("td",fe,i(t.start_date??"--"),1),e("td",_e,i(t.end_date??"--"),1),e("td",me,i(s.filters.formatMoney(t.rent_per_sqft)??"--"),1),e("td",he,[e("div",ye,[a(oe,{href:t.filename,type:"external"},{default:o(()=>[a(re,{class:"bx-cloud-download"})]),_:2},1032,["href"]),a($,{href:s.route("assets.leases.edit",[t.asset_id,t.id]),class:"text-sm",onClick:ve=>A(t)},{default:o(()=>[f(" Delete ")]),_:2},1032,["href","onClick"])])])]))),128))]),_:1}),a(se,{show:x.value,onClose:b},{default:o(()=>[e("div",ge,[xe,e("div",be,[a(te,{onClick:b},{default:o(()=>[f(" Cancel ")]),_:1}),a($,{class:"ml-3",onClick:h[0]||(h[0]=t=>D())},{default:o(()=>[f(" Delete ")]),_:1})])])]),_:1},8,["show"])]),_:1})],64)}}};export{Te as default};
