import{_ as D,h as S,f as V}from"./AuthenticatedLayout-662ab426.js";import{K as M,h as $,m as _,k as N,O as y,C as U,o as d,f as c,a as o,u,w as r,F as b,Z as B,d as f,b as e,s as O,t as n,n as A,g as E}from"./app-d3134876.js";import{V as P,p as j,s as T}from"./filepond-plugin-file-validate-type.esm-8c71bf87.js";import{_ as Y}from"./Pagination-baba0035.js";import{_ as z,a as R,D as K}from"./DangerButton-36c34e0c.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./feather-2b4c9f25.js";const q={class:"py-6"},I={class:"py-6"},J={class:"flex flex-col"},L={class:"overflow-x-auto"},X={class:"inline-block min-w-full align-middle"},Z={class:"overflow-visible"},G={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-600"},H=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",{class:"text-gray-800 dark:text-gray-300"},[e("th",{scope:"col",class:"p-3.5 text-sm text-start font-semibold min-w-[10rem]"}," File Name "),e("th",{scope:"col",class:"p-3.5 text-sm text-start font-semibold min-w-[10rem]"}," Uploaded "),e("th",{scope:"col",class:"p-3.5 text-sm text-start font-semibold min-w-[6rem]"}," File Size "),e("th",{scope:"col",class:"p-3.5 text-sm text-start font-semibold min-w-[8rem]"}," Status "),e("th",{scope:"col",class:"p-3.5 text-sm text-start font-semibold"}," Action ")])],-1),Q={class:"divide-y divide-gray-200 dark:divide-gray-600"},W={class:"p-3.5 text-sm text-gray-700 dark:text-gray-400"},ee=["href"],se={class:"p-3.5 text-sm text-gray-700 dark:text-gray-400"},te={class:"text-xs"},oe={class:"p-3.5 text-sm text-gray-700 dark:text-gray-400"},ae={class:"p-3.5 text-sm text-gray-700 dark:text-gray-400"},le={class:"p-3.5"},re=["onClick"],ne=e("i",{class:"bx bx-trash text-lg hover:text-red-400"},null,-1),ie=[ne],de={class:"p-6"},ce=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this document? ",-1),ue={class:"mt-6 flex justify-end"},ye={__name:"Index",props:{uploaded_files:{type:Object}},setup(x){const h=M(),g=$(()=>h.props.auth.user),{getFileStatusClass:k}=V(),a=_(null),p=_(!1),F=t=>{p.value=!0,a.value=t},m=()=>{p.value=!1,a.value=null},w=async()=>{console.log(a.value),a.value&&y.delete(route("file-upload.destroy",a.value.id),{preserveScroll:!0,onSuccess:()=>{a.value=null,m()}})},C=P(j),v=_([]);let l="";return T({credits:[],required:!0,allowMultiple:!0,allowRevert:!1,acceptedFileTypes:["application/pdf"],server:{process:{url:"/files",headers:{Accept:"application/json","X-CSRF-TOKEN":h.props.csrf},onerror:t=>{console.log("on error"),l=JSON.parse(t)}}},labelFileProcessingError:t=>(console.log(t),l.errors&&l.errors.upload_file?l.errors.upload_file.join(" "):l.message)}),N(()=>{Echo.private(`App.Models.User.${g.value.id}`).listen("FileStatusUpdate",t=>{y.reload({only:["uploaded_files"]})})}),U(()=>{Echo.leave(`App.Models.User.${g.value.id}`)}),(t,i)=>(d(),c(b,null,[o(u(B),{title:"File Upload"}),o(D,null,{header:r(()=>[f(" Files ")]),default:r(()=>[e("div",q,[e("div",I,[o(u(C),{name:"upload_file",ref:"pond","class-name":"my-file-upload","label-idle":"Drag & Drop your PDF files here or <span class='filepond--label-action'>Browse</span>",modelValue:v.value,"onUpdate:modelValue":i[0]||(i[0]=s=>v.value=s)},null,8,["modelValue"])]),e("div",J,[e("div",L,[e("div",X,[e("div",Z,[e("table",G,[H,e("tbody",Q,[(d(!0),c(b,null,O(x.uploaded_files.data,s=>(d(),c("tr",{key:s.id},[e("td",W,[e("a",{href:s.download_link,target:"_blank",rel:"noopener noreferrer",class:"font-medium"},n(s.original_name),9,ee)]),e("td",se,[e("p",null,n(u(S)(s.created_at).format("MMM DD, YYYY h:mma")),1),e("span",te,"by "+n(s.user.name),1)]),e("td",oe,n(s.size_readable),1),e("td",ae,[e("span",{class:A(["inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset",u(k)(s.status)])},n(s.status),3)]),e("td",le,[s.status=="Pending"||s.status=="Completed"?(d(),c("button",{key:0,onClick:pe=>F(s)},ie,8,re)):E("",!0)])]))),128))])])])])])]),o(Y,{dataset:x.uploaded_files,class:"mt-4"},null,8,["dataset"]),o(z,{show:p.value,onClose:m},{default:r(()=>[e("div",de,[ce,e("div",ue,[o(R,{onClick:m},{default:r(()=>[f(" Cancel ")]),_:1}),o(K,{class:"ml-3",onClick:i[1]||(i[1]=s=>w())},{default:r(()=>[f(" Delete File ")]),_:1})])])]),_:1},8,["show"])])]),_:1})],64))}};export{ye as default};
